{% extends 'base.html' %}
{% block title %}Books — Book Bazaar{% endblock %}

{% block content %}
  <section class='mb-6'>
    <div class='max-w-6xl mx-auto flex flex-col md:flex-row md:items-center md:justify-between gap-4'>
      <div>
        <h1 class='text-3xl font-bold'>Discover great books</h1>
        <p class='text-gray-600 mt-1'>Hand-picked books for learning, career, and fun.</p>
      </div>

      <div class='flex gap-3 items-center'>
        <form method='get' action='{% url 'products:product-list' %}' class='flex gap-2'>
          <input name='q' value='{{ q }}' placeholder='Search books, authors...' class='border rounded-full px-3 py-2 w-64 focus:outline-none focus:ring-2 focus:ring-indigo-300' />
          <button type='submit' class='bg-indigo-600 text-white px-3 py-2 rounded-full'>Search</button>
        </form>

        <div class='text-sm text-gray-600'>Showing {{ books.paginator.count }} results</div>
      </div>
    </div>
  </section>

  <div class='grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6'>
    {% for book in books %}
      <article class='bg-white rounded-lg p-4 card-shadow flex flex-col hover:translate-y-[-4px] transition-transform'>
        <div class='h-48 w-full mb-3 overflow-hidden rounded'>
          {% if book.cover %}
            <img src='{{ book.cover.url }}' alt='{{ book.title }}' class='w-full h-full object-cover'>
          {% else %}
            <div class='w-full h-full bg-gray-100 flex items-center justify-center text-gray-400'>No image</div>
          {% endif %}
        </div>

        <div class='flex-1'>
          <h2 class='text-lg font-semibold mb-1'>{{ book.title }}</h2>
          <p class='text-sm text-gray-500 mb-2'>by {{ book.author }}</p>
        </div>

        <div class='mt-3 flex items-center justify-between'>
          <div class='text-xl font-bold'>₹{{ book.price|floatformat:2 }}</div>
          <a href='/books/{{ book.slug }}/' class='inline-block bg-indigo-600 text-white px-4 py-2 rounded'>View</a>
        </div>
      </article>
    {% empty %}
      <p>No books yet. Add some in the admin.</p>
    {% endfor %}
  </div>

  {% if books.paginator.num_pages > 1 %}
    <nav class='mt-8 flex justify-center'>
      <ul class='inline-flex items-center -space-x-px'>
        {% if books.has_previous %}
          <li>
            <a href='?q={{ q }}&page={{ books.previous_page_number }}' class='px-3 py-1 rounded-l border bg-white'>Prev</a>
          </li>
        {% else %}
          <li><span class='px-3 py-1 rounded-l border bg-gray-100 text-gray-400'>Prev</span></li>
        {% endif %}

        {% for p in books.paginator.page_range %}
          {% if p == books.number %}
            <li><span class='px-3 py-1 border bg-indigo-600 text-white'>{{ p }}</span></li>
          {% else %}
            <li><a href='?q={{ q }}&page={{ p }}' class='px-3 py-1 border bg-white text-gray-700'>{{ p }}</a></li>
          {% endif %}
        {% endfor %}

        {% if books.has_next %}
          <li>
            <a href='?q={{ q }}&page={{ books.next_page_number }}' class='px-3 py-1 rounded-r border bg-white'>Next</a>
          </li>
        {% else %}
          <li><span class='px-3 py-1 rounded-r border bg-gray-100 text-gray-400'>Next</span></li>
        {% endif %}
      </ul>
    </nav>
  {% endif %}
{% endblock %}
